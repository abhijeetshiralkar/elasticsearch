SELECT ('MX01' + '@@' + '3070' + '@@' + '10' + '@@' + 'A300'+ '-'+ KS.BundledSKU) AS x_rec_spec,KS.BundledSKU as "Material", KS.ComponentSKU AS Component, CAST(ROW_NUMBER() OVER (PARTITION BY KS.BundledSKU ORDER BY KS.BundledSKU) as VARCHAR(20)) + '@@' + KS.ComponentSKU + '@@' + CAST(KS.Quantity as VARCHAR(20)) AS "OrderedComponent"FROM (SELECT	DISTINCT LTRIM(RTRIM(BundledSku)) AS BundledSku, LTRIM(RTRIM(ComponentSku)) AS ComponentSku, Quantity FROM Catalog.KitSku KS WITH(NOLOCK)INNER JOIN	[Catalog].[CompanyConfiguration] CC WITH(NOLOCK) ON  KS.SalesOrganization = CC.SalesOrganization AND CC.isKitEnabled = 1 INNER JOIN	[Catalog].Materials MB  WITH(NOLOCK) ON KS.BundledSku  = MB.Material AND KS.SalesOrganization = MB.SalesOrganization INNER JOIN	[Catalog].Materials MC  WITH(NOLOCK) ON KS.ComponentSku  = MC.Material AND KS.SalesOrganization = MC.SalesOrganization WHERE KS.SalesOrganization = '3070'AND EffectiveDate <= CONVERT(DATE,GETDATE())AND ExpiryDate >= CONVERT(DATE,GETDATE())AND ( KS.DeleteFlag = 0 OR KS.DeleteFlag IS NULL)AND MB.WebVisibleFlag = 'WebVisibleFlag' AND MB.DeleteFlag IS NULL) AS KS