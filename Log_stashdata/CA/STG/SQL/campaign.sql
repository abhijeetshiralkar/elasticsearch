SELECT 'CA01'+ '@@' + TBL.SalesOrganization + '@@' + TBL.DistributionChannel + '@@' + 'A300'+ '-' + TBL.Material AS "x_rec_spec", TBL.PromotionType, TBL.PromotionCode , TBL.PromotionPoints FROM(SELECT pp.SalesOrganization, pp.DistributionChannel, pp.Material, pp.ValidFromDate, pp.ValidEndDate, pp.PromotionType, pp.PromotionCode, pp.PromotionPoints FROM	PRODUCT_PROMOTION pp WITH (NOLOCK)WHERE	pp.SalesOrganization = '8030'AND ISDATE(pp.ValidFromDate) = 1 AND ISDATE(pp.ValidEndDate) = 1 ) AS TBL WHERE	TBL.ValidFromDate <= GETDATE() AND TBL.ValidEndDate >= GETDATE()